<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>Elevator</title>
<style>
body { margin:0; font-family:sans-serif; background:#1a123f; color:#fff; }
.app { max-width:480px; margin:0 auto; padding:16px; }
.card { background:rgba(155,92,255,0.15); border-radius:12px; padding:12px; margin-bottom:10px; }
.card h3 { margin:0 0 4px 0; font-size:16px; }
.card .meta { font-size:12px; color:#ccc; margin-bottom:6px; }
.card .info { font-size:12px; line-height:1.4; }
input { width:70%; padding:8px; border-radius:8px; border:none; }
button { padding:8px 12px; border:none; border-radius:8px; background:#6e22ff; color:#fff; }
.icons img { width:20px; height:20px; margin-right:4px; }
</style>
</head>
<body>
<div class="app">
  <h2>승강기 검색</h2>
  <input id="q" type="text" placeholder="건물명 입력 (예: 롯데월드)">
  <button id="searchBtn">검색</button>
  <div id="result-list"></div>
</div>

<script>
const btn = document.getElementById('searchBtn');
const qInput = document.getElementById('q');
const list = document.getElementById('result-list');

function getIcons(type){
  const icons = [];
  if(type?.includes('자동차')) icons.push('https://img.icons8.com/ios-filled/50/ffffff/car.png');
  if(type?.includes('승객')) icons.push('https://img.icons8.com/ios-filled/50/ffffff/elevator.png');
  if(type?.includes('화물')) icons.push('https://img.icons8.com/ios-filled/50/ffffff/package.png');
  if(type?.includes('비상')) icons.push('https://img.icons8.com/ios-filled/50/ffffff/alarm.png');
  if(type?.includes('피난')) icons.push('https://img.icons8.com/ios-filled/50/ffffff/running.png');
  if(type?.includes('전망')) icons.push('https://img.icons8.com/ios-filled/50/ffffff/binoculars.png');
  if(type?.includes('장애')) icons.push('https://img.icons8.com/ios-filled/50/ffffff/wheelchair.png');
  if(type?.includes('승객화물')){
    icons.push('https://img.icons8.com/ios-filled/50/ffffff/elevator.png');
    icons.push('https://img.icons8.com/ios-filled/50/ffffff/package.png');
  }
  if(type?.includes('소방')) icons.push('https://img.icons8.com/ios-filled/50/ffffff/fire.png');
  return icons;
}

function createCard(d){
  const div = document.createElement('div');
  div.className='card';
  div.innerHTML=`
    <h3>${d.ElevatorName||d.BuildingName||'-'}</h3>
    <div class="meta">${d.ElevatorNo||'-'} • ${d.ElevatorType||'-'}</div>
    <div class="icons">${getIcons(d.ElevatorType).map(u=>`<img src="${u}">`).join('')}</div>
    <div class="info">
      모델: ${d.Model||'-'}<br>
      용량: ${d.Capacity||'-'}<br>
      층수: ${d.FloorCount||'-'}<br>
      속도: ${d.Speed||'-'}<br>
      제조사: ${d.Manufacturer||'-'}<br>
      설치일: ${d.InstallDate||'-'}
    </div>
  `;
  return div;
}

btn.addEventListener('click', async ()=>{
  list.innerHTML='';
  const keyword = qInput.value.trim();
  if(!keyword) return list.innerHTML="<p>검색어 입력</p>";

  try{
    const res = await fetch(`/search?q=${encodeURIComponent(keyword)}`);
    const data = await res.json();
    if(!data.length){ list.innerHTML="<p>검색 결과 없음</p>"; return; }
    data.forEach(d=>list.appendChild(createCard(d)));
  }catch(e){
    list.innerHTML="<p>API 호출 실패: "+e.message+"</p>";
  }
});
</script>
</body>
</html>
